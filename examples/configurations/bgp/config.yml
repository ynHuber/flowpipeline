---
###############################################################################
# Consume flow messages from a pre-existing Kafka cluster containing
# protobuf-encoded flows in a topic. This topic can be generated by another
# pipeline, or by goflow itself.
- segment: kafkaconsumer
  config:
    server: kafka01.example.com:9093
    topic: flow-messages-plain
    group: enricher-group-1
    user: enricher
    pass: $KAFKA_SASL_PASS

###############################################################################
# This tags all flows with the BGP information regarding their destination
# address. This is done regardless of the router exporting the original
# Netflow, as only the default router is configured for use. This could be a
# route server and is appropriate for smaller networks.
- segment: bgp
  config:
    filename: "bgp.conf"
    fallbackrouter: "default"
    usefallbackonly: 1

###############################################################################
# This demoes a special filter on the AS path. It will drop all flows without
# this information.
- segment: flowfilter
  config:
    filter: passes-through 3320

- segment: printflowdump
